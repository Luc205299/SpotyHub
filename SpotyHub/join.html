<!DOCTYPE html>
<html>

<head>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="stylesheet" type="text/css" href="src/menu.css">
</head>

<body>
  <div class="sidebar">
    <img src="logo.png" alt="Logo" class="logo">
    <h1 class="header-title">SpotiHub</h1>
    <a href="accueil.html">Home Page</a>
    <a href="playlist_hub.html">Playlist Creator</a>
    <a href="Statistique.html">Statistics</a>
    <a href="logout.html">Log out</a>
  </div>
  <div id="info-text">
    <p id = "info-text">Entrez le mail de votre ami pour rejoindre sa session.</p>
    <input id="id" type="text" placeholder="Enter ID">
    <button onclick="send()">Send</button>
  </div>

  <div id="messages"></div>

  <script>
    const token = localStorage.getItem('accessToken');
    console.log(token);
    const userName = localStorage.getItem('username');
    let socket = new WebSocket("wss://websocket--tristano13.repl.co");

    let messageList = [];

    socket.onmessage = function(event) {
      messageList.push(event.data);
      let messageDiv = document.getElementById('messages');
      messageDiv.innerHTML = messageList.map(msg => `<p>${msg}</p>`).join('');
      console.log(messageList);
    };

    function send() {
      let id = document.getElementById('id').value;
      socket.send(JSON.stringify({id, msg: token + ":" + userName}));
    }
  </script>

</body>

</html>
